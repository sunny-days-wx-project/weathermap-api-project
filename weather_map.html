<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WeatherMap API Project</title>

    <!-- Bootstrap style sheet follows-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Mapbox style sheet follows-->
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css' rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />

    <!-- CSS Styling may go here or in separate file-->
    <style>
    #row-header {
        background-color: blue;
        color: white;
        font-family: Helvetica, sans-serif;
    }
    #map {
        border: 2px solid black;
        width: 800px;
        height: 600px;
        box-shadow: 1px 1px;
    }
    </style>

</head>
<body>
    <!--Header Starts Here-->
        <div class="container-fluid">
            <div class="row" id="row-header">
                <div class="col-8  d-flex align-items-center mb-0"><h1 class="mb-0">Weather App</h1></div>
                <div class="col-4 d-flex align-items-center justify-content-end"><p class="mb-0">Current City: San Antonio</p></div>
            </div> <!--End of row-header-->
        </div> <!-- End of this container-->

    <!--Search Bar starts here-->
        <div class="container-fluid">
            <div class="row d-flex align-items-center" id="row-form">
            <form class="form-inline m-0 py-3">

                    <input type="test" class="form-control mx-2" id="location" placeholder="City, State">

                <button type="submit" class="btn btn-primary ml-2">Find</button>
            </form>
            </div> <!--End of row-form div-->
        </div> <!--End of this container-->

    <!--5 Day Forecast Cards Starts here-->
        <div class="container-fluid">
            <div class="row p-2 d-flex justify-content-between">

                <!--Day 1 Card-->
                <div class="card">
                    <div class="card-header" id="date1">Featured</div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">Cras justo odio</li>
                        <li class="list-group-item">Dapibus ac facilisis in</li>
                        <li class="list-group-item">Vestibulum at eros</li>
                    </ul>
                </div> <!--End of day's forecast card-->

                <!--Day 2 Card-->
                <div class="card">
                    <div class="card-header" id="date2">Featured</div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">Cras justo odio</li>
                        <li class="list-group-item">Dapibus ac facilisis in</li>
                        <li class="list-group-item">Vestibulum at eros</li>
                    </ul>
                </div> <!--End of day's forecast card-->

                <!--Day 3 Card-->
                <div class="card">
                    <div class="card-header" id="date3">Featured</div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">Cras justo odio</li>
                        <li class="list-group-item">Dapibus ac facilisis in</li>
                        <li class="list-group-item">Vestibulum at eros</li>
                    </ul>
                </div> <!--End of day's forecast card-->

                <!--Day 4 Card-->
                <div class="card">
                    <div class="card-header" id="date4">Featured</div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">Cras justo odio</li>
                        <li class="list-group-item">Dapibus ac facilisis in</li>
                        <li class="list-group-item">Vestibulum at eros</li>
                    </ul>
                </div> <!--End of day's forecast card-->

                <!--Day 5 Card-->
                <div class="card">
                    <div class="card-header" id="date5">Featured</div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">Cras justo odio</li>
                        <li class="list-group-item">Dapibus ac facilisis in</li>
                        <li class="list-group-item">Vestibulum at eros</li>
                    </ul>
                </div> <!--End of day's forecast card-->
            </div>
        </div>

    <!--Map Viewport Starts Here-->
    <div class="container-fluid">
        <div class="row d-flex justify-content-center py-2">
            <div id='map' class="m-auto"></div>
        </div>
    </div>

    <!-- Mapbox JS -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js'></script>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>

    <!-- AJAX library addition (need AJAX to run AJAX)-->
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <!-- link to the JS file for API key to be held separately-->
    <!--    <script src = "../IdeaProjects/weathermap-api-project/keys.js">-->
    <!--jQuery Library follows (always at the end of the body, but before Bootstrap)-->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <!--Bootstrap Library follows-->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <script>
        const openWeatherMapAPIkey = "feafd6977e777352873ac6e055014150";
        //====================================================
        // Query for CURRENT wx in SATX w/ ajax GET request
        // Console logged the response with .done() method to view data
        $.get("http://api.openweathermap.org/data/2.5/weather", {
            APPID: openWeatherMapAPIkey,
            q:     "San Antonio, US",
            units: "imperial"
        }).done(function(data) {
            console.log("current", data);
        });
        //====================================================

        //====================================================
        // Query for FORECASTED wx in SATX w/ ajax GET request
        $.get("http://api.openweathermap.org/data/2.5/forecast", {
            APPID: openWeatherMapAPIkey,
            q:     "San Antonio, US", //also able to use lat/lon or cityID from database file
            units: "imperial"
        }).done(function(data) {
            console.log('5 day forecast', data);
            getDates(data);
        });
        //====================================================

        //====================================================
        // 'One Call API' is a single request for 'all essential weather data' in SATX
        $.get("http://api.openweathermap.org/data/2.5/onecall", {
            APPID: openWeatherMapAPIkey,
            lat:    29.423017,
            lon:   -98.48527,
            units: "imperial"
        }).done(function(data) {
            console.log('The entire response:', data);
            console.log('Diving in - here is current information: ', data.current);
            console.log('A step further - information for tomorrow: ', data.daily[1]);

        });


        //====================================================

        mapboxgl.accessToken = 'pk.eyJ1IjoibGF1cmEtY29kZXVwIiwiYSI6ImNrcHJjczFyYTBtMHIyb2xlNDBsanlva2EifQ.rXUs9LI80u-fy9wz-bG0Qw';

         let map = new mapboxgl.Map({
            container: 'map', // container ID
            style: 'mapbox://styles/mapbox/streets-v11', // style URL
            center: [-98, 30], // starting position [lng, lat]
            zoom: 9 // starting zoom
        });
    </script>
    <script>
// <!--        write a function that takes the date from the data and separates the date only and returns -->
// $.get("http://api.openweathermap.org/data/2.5/onecall", {
//     APPID: openWeatherMapAPIkey,
//     lat:    29.423017,
//     lon:   -98.48527,
//     units: "imperial"
// }).done(function(data) {
//     getDates(data);
//
// });


// =================================================

//  write a function called getEachMax(maxArr, day) for 8 3-hr sets of list objects returns the Max temp yielding the max temp

// getEachMax(maxArr) {
//  forecast for a 24 hr period then jquerys the result into the correct card using the same $('#maxTemp'+num).html(maxTemp);

//  write a function called getMax(OGdata) which takes in the original 5 day forecast object, loops through 8 3-hour
//  periods, and stores the max temp in an array while using an if condition that executes for i===0, checks if i%8=0 and
//  if i%8 === 0, assigns to var 'day' the value of i/8+1 to reflect which day the max temp is for
//
//  when the i reaches (i%8 === 0) ...
//  then calls getEachMax(maxTemp, day)

// =================================================

// =================================================

//==============  reiterate this for min temp, and if necessary find a way to put max and min in a variable before pushing to CARD ==================

//  write a function called getEachMax(maxArr, day) for 8 3-hr sets of list objects returns the Max temp yielding the max temp

// getEachMax(maxArr) {
//  forecast for a 24 hr period then jquerys the result into the correct card using the same $('#maxTemp'+num).html(maxTemp);

//  write a function called getMax(OGdata) which takes in the original 5 day forecast object, loops through 8 3-hour
//  periods, and stores the max temp in an array while using an if condition that executes for i===0, checks if i%8=0 and
//  if i%8 === 0, assigns to var 'day' the value of i/8+1 to reflect which day the max temp is for
//
//  when the i reaches (i%8 === 0) ...
//  then calls getEachMax(maxTemp, day)

// =================================================

// <!--        assign the date from the array to a variable-->
function getDate(someData, i) {
    // gets list zero and assigns the date-time to a variable
    // var dateTime = someData
    // create a substring that contains just the date
    var date = someData.substring(0, 10);
    console.log(i);
    console.log(date);
    // put the date into an html package and assign it to the inner html of the card element
    // create a variable to hold an element that best communicates a date for our purposes i.e. <em>
    // jquery the 'featured' div by ID  by concatenating the iteration / 8 + 1 number stored in a num variable to the end of $('#date'+num).html(dateVariable);

}

function getDates(OGDateArray) {
    // assign original weather object 3 hour forecasts to a variable
    var threeHourForecasts = OGDateArray.list;
    // create a loop that  finds each new date
    for (var i = 0; i<threeHourForecasts.length; i+=8) {
        // getDate(threeHourForecasts[i].dt_txt, i);
        // create a variable that holds this date
        var dateArray = threeHourForecasts[i];
        // console.log(dateArray);
        // console.log(dateArray.dt_txt);
        var theActualDate = dateArray.dt_txt;
        // call getDate with this date and iteration value
        getDate(theActualDate, i);
    }
}
// <!--        -->

    </script>

<!--============================================================-->

<!--============================================================-->

</body>
</html>